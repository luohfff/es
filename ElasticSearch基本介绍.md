## 一、ElasticSearch基本介绍
### 1.1ElasticSearch(简称ES)
Elasticsearch是用Java开发并且是当前最流行的开源的企业级搜索引擎。能够达到实时搜索，稳定，可靠，快速，安装使用方便。客户端支持Java、.NET（C#）、PHP、Python、Ruby等多种语言。
官方网站: https://www.elastic.co/
下载地址：https://www.elastic.co/cn/start

创始人:Shay Banon（谢巴农）

![image-20230427141327734](C:\Users\l30037108\AppData\Roaming\Typora\typora-user-images\image-20230427141327734.png)
### 1.2 Lucene
Lucene可以被认为是迄今为止最先进、性能最好的、功能最全的搜索引擎库（框架）但是想要使用Lucene，必须使用Java来作为开发语言并将其直接集成到你的应用中，并且Lucene的配置及使用非常复杂，你需要深入了解检索的相关知识来理解它是如何工作的。
Lucene缺点：
1）只能在Java项目中使用,并且要以jar包的方式直接集成项目中.
2）使用非常复杂-创建索引和搜索索引代码繁杂
3）不支持集群环境-索引数据不同步（不支持大型项目）
4）索引数据如果太多就不行，索引库和应用所在同一个服务器,共同占用硬
盘.共用空间少.
**ElasticSearch底层是基于Lucence运行的**

### 1.3 基本概念
1. **什么是全文检索**
    全文检索是指：
    通过一个程序扫描文本中的每一个单词，针对单词建立索引，并保存该单
    词在文本中的位置、以及出现的次数
    用户查询时，通过之前建立好的索引来查询，将索引中单词对应的文本位
    置、出现的次数返回给用户，因为有了具体文本的位置，所以就可以将具体内
    容读取出来了

2. **倒排索引**
    Elasticsearch 使用一种称为 倒排索引 的结构，它适用于快速的全文搜索。一个倒排索引由文档中所有不重复词的列表构成，对于其中每个词，有一个包含它的文档列表。

  ![image-20230427164805498](C:\Users\l30037108\AppData\Roaming\Typora\typora-user-images\image-20230427164805498.png)

3. **分词与分词器**
    **文本分析**（Analysis）就是把全文本转换成一系列单词的过程，这个过程也叫做**分词**。在ES中，分词是通过**分词器**（Analyzer）来完成的
    **分词器的组成**
    **Character** **Filters**：针对原始文本处理，比如去除 html 标签
    **Tokenizer**：按照规则切分为单词，比如按照空格切分
    **Token** **Filters**：将切分的单词进行加工，比如大写转小写，删除 stopwords（a,the,is），增加同义语
4. **ES内置分词器**
   Standard Analyzer - 默认分词器，按词切分，小写处理
   Simple Analyzer - 按照非字母切分（符号被过滤），小写处理
   Stop Analyzer - 小写处理，停用词过滤（the ，a，is）
   Whitespace Analyzer - 按照空格切分，不转小写
   Keyword Analyzer - 不分词，直接将输入当做输出
   Pattern Analyzer - 正则表达式，默认 \W+
   Language - 提供了 30 多种常见语言的分词器
   Customer Analyzer - 自定义分词器
5. **中文分词**
   ES内置的分词器对中文并不友好,对于中文分词需要我们下载对应的中文友好的分词器,目前市面上比较受欢迎的中文分词器有:
   IK：
     支持自定义词库，支持热更新分词字典
     https://github.com/medcl/elasticsearch-analysis-ik
   jieba：
     Python 中最流行的分词系统，支持分词和词性标注
     支持繁体分词、自定义词典、并行分词等
    https://github.com/sing1ee/elasticsearch-jieba-plugin

### 1.4 ES中的核心概念
1. **索引 index**
   索引就是存储相同特征文档的集合,它类似于关系型数据库中的表的概念。一个索引由一个名字来标识，必须是小写字母。
2. **文档 document**
   一个文档是一个可被索引的基础信息单元，类似一条记录。文档以JSON（Javascript Object
   Notation）格式来表示
3. **映射 mapping**
   映射是对处理数据的方式和规则方面定义的一些限制，它类似于关系型数据库中的scheme概念，比如，映射可以定义某个字段的名字，类型，默认值，分词器，是否被索引等
4. **字段 field**
   相当于关系型数据库中的column概念
5. **字段类型 type**
   每一个字段都有对应的类型，常用的类型有
   字符串：string，string类型包含 text 和 keyword。
   text：该类型被用来索引长文本，在创建索引前会将这些文本进行分词，转化为
   词的组合，建立索引；允许es来检索这些词，text类型不能用来排序和聚合。
   keyword：该类型不能分词，可以被用来检索过滤、排序和聚合，keyword类型不
   可进行分词模糊检索。
   数值型：long、integer、short、byte、double、float
   日期型：date
   布尔型：boolean
6. **集群 cluster**
   ES作为一个分布式搜索引擎，支持集群的搭建，一个集群就是由一个或多个节点组织在一起，他们共同持有整个数据，并一起提供索引和搜索功能
7. **节点 node**
   一个节点是集群中的一个服务器，作为集群的一部分，它存储数据，参与集群的索
   引和搜索功能。
   一个节点可以通过配置集群名称的方式来加入一个指定的集群。默认情况下，每
   个节点都会被安排加入到一个叫做“elasticsearch”的集群中。
   这意味着，如果在网络中启动了若干个节点，并假定它们能够相互发现彼此，它们
   将会自动地形成并加入到一个叫做“elasticsearch”的集群中。
   在一个集群里，可以拥有任意多个节点。而且，如果当前网络中没有运行任何
   Elasticsearch节点，这时启动一个节点，会默认创建并加入一个叫
   做“elasticsearch”的集群。
8. **分片 shards**
   假如某个索引有超过10亿个文档，所占的存储空间超过1TB，而任一节点都没有这样大的磁盘空间，或者单个节点处理搜索请求，响应太慢。为了解决这个问题，Elasticsearch提供了将索引划分成多份的能力，这就叫做分片
9. **副本 replicas**
   为了解决集群中某个节点突然宕机而造成数据的丢失，es同时也提供了备份的功能，为每个分片生成了一个或多个副本，分别存储在不同的节点中，同时副本与主分片不能存储在同一个节点中。

例子：

